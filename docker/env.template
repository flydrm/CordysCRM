# ============================================================================
# Cordys CRM - 环境变量配置模板
# 
# 使用说明：
#   1. 复制此文件为 .env: cp env.template .env
#   2. 根据实际情况修改配置值
#   3. 运行 docker compose up -d
#
# 密码特殊字符说明：
#   - 此文件中可以直接写入包含特殊字符的密码，无需转义
#   - 示例: MYSQL_PASSWORD=P@ss$word!#123 (直接写入即可)
#   - 但在命令行中使用 -e 参数时，需要用单引号包裹或转义特殊字符
# ============================================================================

# ============================================================
# 基础配置
# ============================================================

# 版本号（用于拉取指定版本镜像）
CRM_VERSION=latest

# 时区设置
TZ=Asia/Shanghai

# ============================================================
# 端口配置
# ============================================================

# Web 应用端口
WEB_PORT=8081

# MCP Server 端口（AI 智能体服务）
MCP_PORT=8082

# MySQL 端口（仅分离模式暴露）
MYSQL_PORT=3306

# Redis 端口（仅分离模式暴露）
REDIS_PORT=6379

# ============================================================
# MySQL 数据库配置
# ============================================================

# 外部 MySQL 服务地址（配置后将禁用内置 MySQL）
# 示例：rm-xxxx.mysql.rds.aliyuncs.com 或 192.168.1.100
# MYSQL_HOST=

# MySQL 端口
# MYSQL_PORT=3306

# MySQL 数据库名
MYSQL_DATABASE=cordys-crm

# MySQL root 密码（建议修改为强密码）
MYSQL_ROOT_PASSWORD=CordysCRM@mysql

# MySQL 应用用户名
MYSQL_USER=cordys
# 外部模式使用 MYSQL_USERNAME
# MYSQL_USERNAME=cordys

# MySQL 应用用户密码（建议修改为强密码）
MYSQL_PASSWORD=CordysCRM@mysql

# MySQL SSL 连接（生产环境建议开启）
# MYSQL_SSL=false

# MySQL 连接池配置
# MYSQL_POOL_MIN=5
# MYSQL_POOL_MAX=20

# ============================================================
# Redis 缓存配置
# ============================================================

# 外部 Redis 服务地址（配置后将禁用内置 Redis）
# 示例：r-xxxx.redis.rds.aliyuncs.com 或 192.168.1.101
# REDIS_HOST=

# Redis 端口
# REDIS_PORT=6379

# Redis 密码（建议修改为强密码）
REDIS_PASSWORD=CordysCRM@redis

# ============================================================
# 应用配置
# ============================================================

# JVM 参数配置
# 开发环境：-Xms256m -Xmx512m
# 生产环境：-Xms2g -Xmx4g -XX:+UseG1GC
JAVA_OPTS=-Xms512m -Xmx1024m

# 会话超时时间
SESSION_TIMEOUT=30d

# ============================================================
# MCP Server 配置（AI 智能体）
# ============================================================

# 是否启用 MCP Server
MCP_ENABLED=true

# CRM 系统访问 URL（用于 MCP 回调）
CRM_URL=http://localhost:8081

# ============================================================
# SQLBot 智能问数配置（可选）
# ============================================================

# 是否加密 SQLBot API 返回的敏感数据
# SQLBOT_ENCRYPT=false

# SQLBot AES 加密密钥（16/24/32 字节）
# SQLBOT_AES_KEY=your-aes-key-here

# SQLBot AES 初始化向量（16 字节）
# SQLBOT_AES_IV=your-aes-iv-here

# ============================================================
# 外部服务集成配置（可选）
# ============================================================

# MaxKB 智能体平台地址
# MAXKB_ADDRESS=https://maxkb.example.com

# DataEase BI 平台地址
# DATAEASE_ADDRESS=https://dataease.example.com

# ============================================================
# 生产环境配置
# ============================================================

# 数据存储路径（生产环境建议配置）
DATA_PATH=./data

# JVM 内存配置（根据服务器内存调整）
JVM_XMS=512m
JVM_XMX=1024m

# 资源限制
LIMIT_CPU=4
LIMIT_MEMORY=4G
RESERVE_CPU=1
RESERVE_MEMORY=1G

# ============================================================
# Traefik 反向代理配置（外部服务模式使用）
# ============================================================

# Traefik 网络名称（需预先创建: docker network create traefik-public）
TRAEFIK_NETWORK=traefik-public

# Web 应用域名
TRAEFIK_HOST=crm.example.com

# MCP Server 域名（可选，如不需要可设置与 TRAEFIK_HOST 相同）
TRAEFIK_MCP_HOST=mcp.example.com

# Traefik 入口点
TRAEFIK_ENTRYPOINT=websecure

# 是否启用 TLS
TRAEFIK_TLS=true

# 证书解析器（需在 Traefik 中配置）
TRAEFIK_CERT_RESOLVER=letsencrypt

# ============================================================
# 第三方平台集成（可选）
# ============================================================

# 企业微信 Corp ID
# WECOM_CORP_ID=

# 企业微信 Agent ID
# WECOM_AGENT_ID=

# 企业微信 Secret
# WECOM_SECRET=

# 钉钉 App Key
# DINGTALK_APP_KEY=

# 钉钉 App Secret
# DINGTALK_APP_SECRET=

# 飞书 App ID
# LARK_APP_ID=

# 飞书 App Secret
# LARK_APP_SECRET=

# ============================================================
# 注意：外部服务模式请使用 env.external.template
# ============================================================
# 如需连接外部 MySQL/Redis 服务，请使用专用配置模板：
# cp env.external.template .env
# docker compose -f docker-compose.external.yml up -d

